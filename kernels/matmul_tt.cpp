#include \"tt_metal/host_api.hpp\"\n#include \"tt_metal/common/constants.hpp\"\n\nvoid kernel_main() {\n    uint32_t a_addr = get_arg_val<uint32_t>(0);\n    uint32_t b_addr = get_arg_val<uint32_t>(1);\n    uint32_t c_addr = get_arg_val<uint32_t>(2);\n    uint32_t M = get_arg_val<uint32_t>(3);\n    uint32_t N = get_arg_val<uint32_t>(4);\n    uint32_t K = get_arg_val<uint32_t>(5);\n    \n    constexpr uint32_t TILE_SIZE = 32;\n    \n    uint32_t core_x = get_core_pos_x();\n    uint32_t core_y = get_core_pos_y();\n    \n    uint32_t start_row = core_y * TILE_SIZE;\n    uint32_t start_col = core_x * TILE_SIZE;\n    \n    uint32_t end_row = min(start_row + TILE_SIZE, M);\n    uint32_t end_col = min(start_col + TILE_SIZE, N);\n    \n    for (uint32_t i = start_row; i < end_row; i++) {\n        for (uint32_t j = start_col; j < end_col; j++) {\n            float acc = 0.0f;\n            \n            for (uint32_t k = 0; k < K; k++) {\n                float a_val = *reinterpret_cast<float*>(a_addr + (i * K + k) * sizeof(float));\n                float b_val = *reinterpret_cast<float*>(b_addr + (k * N + j) * sizeof(float));\n                acc += a_val * b_val;\n            }\n            \n            *reinterpret_cast<float*>(c_addr + (i * N + j) * sizeof(float)) = acc;\n        }\n    }\n}